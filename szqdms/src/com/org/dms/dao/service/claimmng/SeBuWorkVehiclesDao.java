package com.org.dms.dao.service.claimmng;import com.org.dms.vo.service.SeBuWorkVehiclesVO;import com.org.framework.base.BaseDAO;import com.org.framework.common.BaseResultSet;import com.org.framework.common.PageManager;import com.org.framework.common.QuerySet;import com.org.framework.common.User;import com.org.mvc.context.ActionContext; /**   * SeBuWorkVehiclesDao   * <p>Company: szq</p>   * @author baixiaoliang   * @version 1.0  2014-7-14  */public class SeBuWorkVehiclesDao extends BaseDAO{   public  static final SeBuWorkVehiclesDao getInstance(ActionContext atx)    {	   SeBuWorkVehiclesDao dao = new SeBuWorkVehiclesDao(); 	   atx.setDBFactory(dao.factory);	   return dao;   }   /**    * 查询    * @param page    * @param user    * @param conditions    * @return    * @throws Exception    */   public BaseResultSet search(PageManager page, User user, String conditions) throws Exception   {   		String wheres = conditions;   		String orgId=user.getOrgId();   		wheres += " AND T.ORG_ID = "+orgId+" \n"+   				  " ORDER BY T.VEHICLE_ID ";   		page.setFilter(wheres);   		//定义返回结果集   		BaseResultSet bs = null;   		StringBuffer sql= new StringBuffer();   		sql.append("SELECT T.COMPANY_ID,\n" );   		sql.append("       T.CREATE_TIME,\n" );   		sql.append("       T.CREATE_USER,\n" );   		sql.append("       T.ENGINE_NO,\n" );   		sql.append("       T.LICENSE_PLATE,\n" );   		sql.append("       T.MODELS_TYPE,\n" );   		sql.append("       T.ORG_ID,\n" );   		sql.append("       T.REMARKS,\n" );   		sql.append("       T.STATUS,\n" );   		sql.append("       T.UPDATE_TIME,\n" );   		sql.append("       T.UPDATE_USER,\n" );   		sql.append("       T.VEHICLE_ID,\n" );   		sql.append("       T.VIN,\n" );   		sql.append("       T.VEHICLE_STATUS\n" );   		sql.append("  FROM SE_BU_WORK_VEHICLES T");   		bs = factory.select(sql.toString(), page);   		bs.setFieldDateFormat("CREATE_TIME", "yyyy-MM-dd");   		bs.setFieldDateFormat("UPDATE_TIME", "yyyy-MM-dd");   		bs.setFieldDic("STATUS","YXBS");   		bs.setFieldDic("VEHICLE_STATUS","YXBS");   		return bs;    }	 /**	   * @auther baixiaoliang	   * @return String	  */   public boolean insert(SeBuWorkVehiclesVO vo) throws Exception {	   return factory.insert(vo);   }	 /**	   *  	   * @return boolean 	  */   public boolean update(SeBuWorkVehiclesVO vo) throws Exception {       return factory.update(vo);   }	 /**	 @throws Exception    设定文件 	   * @return QuerySet    返回类型 	  */   public QuerySet check(String vehicleId) throws Exception   {		QuerySet qs = null;		StringBuffer sql = new StringBuffer();		sql.append("  SELECT COUNT(1) NUMS FROM  SE_BU_WORK_VEHICLES ");		sql.append("  WHERE VEHICLE_ID=");		sql.append(vehicleId );		qs = factory.select(null, sql.toString());		return qs;   } 	 /**	 @throws Exception    设定文件 	   * @return boolean    返回类型 	  */   public boolean delete(String vehicleId) throws Exception   {	   StringBuffer sql = new StringBuffer();	   sql.append("  DELETE SE_BU_WORK_VEHICLES ");	   sql.append("  WHERE VEHICLE_ID=");	   sql.append(vehicleId );	   return factory.delete(sql.toString(), null);   }}
