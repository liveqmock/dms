package com.org.dms.dao.service.claimmng;import com.org.dms.vo.service.SeBuWorkOrderVO;import com.org.framework.base.BaseDAO;import com.org.framework.common.BaseResultSet;import com.org.framework.common.PageManager;import com.org.framework.common.QuerySet;import com.org.framework.common.User;import com.org.mvc.context.ActionContext; /**   * SeBuWorkOrderDao   * <p>Company: szq</p>   * @author baixiaoliang   * @version 1.0  2014-7-14  */public class SeBuWorkOrderDao extends BaseDAO{ 		   //定义instance    public  static final SeBuWorkOrderDao getInstance(ActionContext atx) {SeBuWorkOrderDao dao = new SeBuWorkOrderDao();  atx.setDBFactory(dao.factory);return dao; }  /**   * @auther baixiaoliang   * @return String  */ public boolean insert(SeBuWorkOrderVO vo) throws Exception {         return factory.insert(vo);       } /**   *     * @return boolean   */ public boolean update(SeBuWorkOrderVO vo) throws Exception {         return factory.update(vo);       } /** @throws Exception    设定文件    * @return BaseResultSet    返回类型   */ public BaseResultSet search(PageManager page, User user, String conditions) throws Exception{	String wheres = conditions;// wheres += " AND T.MODELS_ID = B.MODELS_ID AND T.POSITION_ID = C.POSITION_ID";	String orgId=user.getOrgId();	wheres += " AND T.ORG_ID = "+orgId+" \n"+			  " ORDER BY T.WORK_ID ";	  page.setFilter(wheres);	  //定义返回结果集	  BaseResultSet bs = null;StringBuffer sql = new StringBuffer();sql.append("  SELECT  ");    sql.append(" T.APPLY_ADDRESS,");    sql.append(" T.APPLY_DATE,");    sql.append(" T.APPLY_MOBIL,");    sql.append(" T.APPLY_REMARKS,");    sql.append(" T.APPLY_USER,");    sql.append(" T.ARRIVE_DATE,");    sql.append(" T.COMPANY_ID,");    sql.append(" T.COMPLETE_DATE,");    sql.append(" T.CREATE_TIME,");    sql.append(" T.CREATE_USER,");    sql.append(" T.END_LATITUDE,");    sql.append(" T.END_LONGITUDE,");    sql.append(" T.GO_DATE,");    sql.append(" T.IF_OUT,");    sql.append(" T.OEM_COMPANY_ID,");    sql.append(" T.ORG_ID,");    sql.append(" T.REJECTION_DATE,");    sql.append(" T.REPAIR_DATE,");    sql.append(" T.REPAIR_USER,");    sql.append(" T.REP_USER_TEL,");    sql.append(" T.SECRET_LEVEL,");    sql.append(" T.START_LATITUDE,");    sql.append(" T.START_LONGITUDE,");    sql.append(" T.STATUS,");    sql.append(" T.UPDATE_TIME,");    sql.append(" T.UPDATE_USER,");    sql.append(" T.WORK_ID,");    sql.append(" T.WORK_NO,");    sql.append(" T.WORK_STATUS,");    sql.append(" T.WORK_TYPE");sql.append(" FROM SE_BU_WORK_ORDER T ");//执行方法，不需要传递conn参数bs = factory.select(sql.toString(), page);    bs.setFieldDateFormat("APPLY_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("ARRIVE_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("COMPLETE_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("CREATE_TIME", "yyyy-MM-dd");    bs.setFieldDateFormat("GO_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("REJECTION_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("REPAIR_DATE", "yyyy-MM-dd");    bs.setFieldDateFormat("UPDATE_TIME", "yyyy-MM-dd");		bs.setFieldDic("STATUS","YXBS");	//	bs.setFieldDic("USER_TYPE","CLYHLX");//绑定组织字典，将ORG_ID翻译为组织名称//bs.setFieldOrgDeptSimpleName("ORG_ID");//bs.setFieldOrgCompanySimpleName("COMPANY_ID"); return bs; } /** @throws Exception    设定文件    * @return QuerySet    返回类型   */public QuerySet check(String workId) throws Exception{QuerySet qs = null;StringBuffer sql = new StringBuffer();sql.append("  SELECT COUNT(1) NUMS FROM  SE_BU_WORK_ORDER ");sql.append("  WHERE WORK_ID=");sql.append(workId );qs = factory.select(null, sql.toString());return qs; }  /** @throws Exception    设定文件    * @return boolean    返回类型   */public boolean delete(String workId) throws Exception{StringBuffer sql = new StringBuffer();sql.append("  DELETE SE_BU_WORK_ORDER ");sql.append("  WHERE WORK_ID=");sql.append(workId );return factory.delete(sql.toString(), null); } }
