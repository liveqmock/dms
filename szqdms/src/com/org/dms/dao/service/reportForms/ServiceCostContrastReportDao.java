package com.org.dms.dao.service.reportForms;

import java.sql.SQLException;

import com.org.framework.base.BaseDAO;
import com.org.framework.common.BaseResultSet;
import com.org.framework.common.PageManager;
import com.org.framework.common.QuerySet;
import com.org.framework.common.User;
import com.org.mvc.context.ActionContext;

/**
 * 服务费用对比查询DAO
 * @author Administrator
 *
 */
public class ServiceCostContrastReportDao extends BaseDAO
{
    //定义instance
    public  static final ServiceCostContrastReportDao getInstance(ActionContext atx)
    {
    	ServiceCostContrastReportDao dao = new ServiceCostContrastReportDao();
        atx.setDBFactory(dao.factory);
        return dao;
    }

    /**
     * 零件保修更换数量台帐	
     */
    public BaseResultSet search(PageManager page, User user, String year,String bYear) throws SQLException{
    	BaseResultSet bs = null;

    	StringBuffer sql= new StringBuffer();
    	sql.append("SELECT D.ONAME OFFICE_NAME,A.ORG_CODE,C.ONAME ORG_NAME,WORK_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS1-OLDWORK_COSTS12)/OLDWORK_COSTS12, 2)\n" );
    	sql.append("       END A1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS1-OLDWORK_COSTS1)/OLDWORK_COSTS1, 2)\n" );
    	sql.append("       END B1,\n" );
    	sql.append("       WORK_COSTS2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS2-WORK_COSTS1)/WORK_COSTS1, 2)\n" );
    	sql.append("       END A2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS2-OLDWORK_COSTS2)/OLDWORK_COSTS2, 2)\n" );
    	sql.append("       END B2,\n" );
    	sql.append("       WORK_COSTS3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN WORK_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS3-WORK_COSTS2)/WORK_COSTS2, 2)\n" );
    	sql.append("       END A3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS3-OLDWORK_COSTS3)/OLDWORK_COSTS3, 2)\n" );
    	sql.append("       END B3,\n" );
    	sql.append("       WORK_COSTS4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN WORK_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS4-WORK_COSTS3)/WORK_COSTS3, 2)\n" );
    	sql.append("       END A4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS4-OLDWORK_COSTS4)/OLDWORK_COSTS4, 2)\n" );
    	sql.append("       END B4,\n" );
    	sql.append("       WORK_COSTS5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS5-WORK_COSTS4)/WORK_COSTS4, 2)\n" );
    	sql.append("       END A5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS5-OLDWORK_COSTS5)/OLDWORK_COSTS5, 2)\n" );
    	sql.append("       END B5,\n" );
    	sql.append("       WORK_COSTS6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN WORK_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS6-WORK_COSTS5)/WORK_COSTS5, 2)\n" );
    	sql.append("       END A6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS6-OLDWORK_COSTS6)/OLDWORK_COSTS6, 2)\n" );
    	sql.append("       END B6,\n" );
    	sql.append("       WORK_COSTS7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS7-WORK_COSTS6)/WORK_COSTS6, 2)\n" );
    	sql.append("       END A7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS7-OLDWORK_COSTS7)/OLDWORK_COSTS7, 2)\n" );
    	sql.append("       END B7,\n" );
    	sql.append("       WORK_COSTS8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN WORK_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS8-WORK_COSTS7)/WORK_COSTS7, 2)\n" );
    	sql.append("       END A8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS8-OLDWORK_COSTS8)/OLDWORK_COSTS8, 2)\n" );
    	sql.append("       END B8,\n" );
    	sql.append("       WORK_COSTS9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS9-WORK_COSTS8)/WORK_COSTS8, 2)\n" );
    	sql.append("       END A9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS9-OLDWORK_COSTS9)/OLDWORK_COSTS9, 2)\n" );
    	sql.append("       END B9,\n" );
    	sql.append("       WORK_COSTS10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS10-WORK_COSTS9)/WORK_COSTS9, 2)\n" );
    	sql.append("       END A10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS10-OLDWORK_COSTS10)/OLDWORK_COSTS10, 2)\n" );
    	sql.append("       END B10,\n" );
    	sql.append("       WORK_COSTS11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS11-WORK_COSTS10)/WORK_COSTS10, 2)\n" );
    	sql.append("       END A11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS11-OLDWORK_COSTS11)/OLDWORK_COSTS11, 2)\n" );
    	sql.append("       END B11,\n" );
    	sql.append("       WORK_COSTS12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN WORK_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS12-WORK_COSTS11)/WORK_COSTS11, 2)\n" );
    	sql.append("       END A12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS12-OLDWORK_COSTS12)/OLDWORK_COSTS12, 2)\n" );
    	sql.append("       END B12,\n" );
    	sql.append("       MATERIAL_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS1-OLDMATERIAL_COSTS12)/OLDMATERIAL_COSTS12, 2)\n" );
    	sql.append("       END C1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS1-OLDMATERIAL_COSTS1)/OLDMATERIAL_COSTS1, 2)\n" );
    	sql.append("       END D1,\n" );
    	sql.append("       MATERIAL_COSTS2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS2-MATERIAL_COSTS1)/MATERIAL_COSTS1, 2)\n" );
    	sql.append("       END C2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS2-OLDMATERIAL_COSTS2)/OLDMATERIAL_COSTS2, 2)\n" );
    	sql.append("       END D2,\n" );
    	sql.append("       MATERIAL_COSTS3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS3-MATERIAL_COSTS2)/MATERIAL_COSTS2, 2)\n" );
    	sql.append("       END C3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS3-OLDMATERIAL_COSTS3)/OLDMATERIAL_COSTS3, 2)\n" );
    	sql.append("       END D3,\n" );
    	sql.append("       MATERIAL_COSTS4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS4-MATERIAL_COSTS3)/MATERIAL_COSTS3, 2)\n" );
    	sql.append("       END C4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS4-OLDMATERIAL_COSTS4)/OLDMATERIAL_COSTS4, 2)\n" );
    	sql.append("       END D4,\n" );
    	sql.append("       MATERIAL_COSTS5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS5-MATERIAL_COSTS4)/MATERIAL_COSTS4, 2)\n" );
    	sql.append("       END C5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS5-OLDMATERIAL_COSTS5)/OLDMATERIAL_COSTS5, 2)\n" );
    	sql.append("       END D5,\n" );
    	sql.append("       MATERIAL_COSTS6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS6-MATERIAL_COSTS5)/MATERIAL_COSTS5, 2)\n" );
    	sql.append("       END C6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS6-OLDMATERIAL_COSTS6)/OLDMATERIAL_COSTS6, 2)\n" );
    	sql.append("       END D6,\n" );
    	sql.append("       MATERIAL_COSTS7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS7-MATERIAL_COSTS6)/MATERIAL_COSTS6, 2)\n" );
    	sql.append("       END C7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS7-OLDMATERIAL_COSTS7)/OLDMATERIAL_COSTS7, 2)\n" );
    	sql.append("       END D7,\n" );
    	sql.append("       MATERIAL_COSTS8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS8-MATERIAL_COSTS7)/MATERIAL_COSTS7, 2)\n" );
    	sql.append("       END C8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS8-OLDMATERIAL_COSTS8)/OLDMATERIAL_COSTS8, 2)\n" );
    	sql.append("       END D8,\n" );
    	sql.append("       MATERIAL_COSTS9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS9-MATERIAL_COSTS8)/MATERIAL_COSTS8, 2)\n" );
    	sql.append("       END C9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS9-OLDMATERIAL_COSTS9)/OLDMATERIAL_COSTS9, 2)\n" );
    	sql.append("       END D9,\n" );
    	sql.append("       MATERIAL_COSTS10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS10-MATERIAL_COSTS9)/MATERIAL_COSTS9, 2)\n" );
    	sql.append("       END C10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS10-OLDMATERIAL_COSTS10)/OLDMATERIAL_COSTS10, 2)\n" );
    	sql.append("       END D10,\n" );
    	sql.append("       MATERIAL_COSTS11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS11-MATERIAL_COSTS10)/MATERIAL_COSTS10, 2)\n" );
    	sql.append("       END C11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS11-OLDMATERIAL_COSTS11)/OLDMATERIAL_COSTS11, 2)\n" );
    	sql.append("       END D11,\n" );
    	sql.append("       MATERIAL_COSTS12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS12-MATERIAL_COSTS11)/MATERIAL_COSTS11, 2)\n" );
    	sql.append("       END C12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS12-OLDMATERIAL_COSTS12)/OLDMATERIAL_COSTS12, 2)\n" );
    	sql.append("       END D12,\n" );
    	sql.append("       SUMMARY1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDSUMMARY12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY1-OLDSUMMARY12)/OLDSUMMARY12, 2)\n" );
    	sql.append("       END E1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY1-OLDSUMMARY1)/OLDSUMMARY1, 2)\n" );
    	sql.append("       END F1,\n" );
    	sql.append("       SUMMARY2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY2-SUMMARY1)/SUMMARY1, 2)\n" );
    	sql.append("       END E2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY2-OLDSUMMARY2)/OLDSUMMARY2, 2)\n" );
    	sql.append("       END F2,\n" );
    	sql.append("       SUMMARY3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN SUMMARY2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY3-SUMMARY2)/SUMMARY2, 2)\n" );
    	sql.append("       END E3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY3-OLDSUMMARY3)/OLDSUMMARY3, 2)\n" );
    	sql.append("       END F3,\n" );
    	sql.append("       SUMMARY4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN SUMMARY3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY4-SUMMARY3)/SUMMARY3, 2)\n" );
    	sql.append("       END E4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY4-OLDSUMMARY4)/OLDSUMMARY4, 2)\n" );
    	sql.append("       END F4,\n" );
    	sql.append("       SUMMARY5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY5-SUMMARY4)/SUMMARY4, 2)\n" );
    	sql.append("       END E5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY5-OLDSUMMARY5)/OLDSUMMARY5, 2)\n" );
    	sql.append("       END F5,\n" );
    	sql.append("       SUMMARY6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN SUMMARY5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY6-SUMMARY5)/SUMMARY5, 2)\n" );
    	sql.append("       END E6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY6-OLDSUMMARY6)/OLDSUMMARY6, 2)\n" );
    	sql.append("       END F6,\n" );
    	sql.append("       SUMMARY7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY7-SUMMARY6)/SUMMARY6, 2)\n" );
    	sql.append("       END E7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY7-OLDSUMMARY7)/OLDSUMMARY7, 2)\n" );
    	sql.append("       END F7,\n" );
    	sql.append("       SUMMARY8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN SUMMARY7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY8-SUMMARY7)/SUMMARY7, 2)\n" );
    	sql.append("       END E8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY8-OLDSUMMARY8)/OLDSUMMARY8, 2)\n" );
    	sql.append("       END F8,\n" );
    	sql.append("       SUMMARY9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY9-SUMMARY8)/SUMMARY8, 2)\n" );
    	sql.append("       END E9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY9-OLDSUMMARY9)/OLDSUMMARY9, 2)\n" );
    	sql.append("       END F9,\n" );
    	sql.append("       SUMMARY10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY10-SUMMARY9)/SUMMARY9, 2)\n" );
    	sql.append("       END E10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY10-OLDSUMMARY10)/OLDSUMMARY10, 2)\n" );
    	sql.append("       END F10,\n" );
    	sql.append("       SUMMARY11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY11-SUMMARY10)/SUMMARY10, 2)\n" );
    	sql.append("       END E11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY11-OLDSUMMARY11)/OLDSUMMARY11, 2)\n" );
    	sql.append("       END F11,\n" );
    	sql.append("       SUMMARY12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN SUMMARY11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY12-SUMMARY11)/SUMMARY11, 2)\n" );
    	sql.append("       END E12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY12-OLDSUMMARY12)/OLDSUMMARY12, 2)\n" );
    	sql.append("       END F12,\n" );
    	sql.append("       OUT_COSTS1,\n" );
    	sql.append("       OUT_COSTS2,\n" );
    	sql.append("       OUT_COSTS3,\n" );
    	sql.append("       OUT_COSTS4,\n" );
    	sql.append("       OUT_COSTS5,\n" );
    	sql.append("       OUT_COSTS6,\n" );
    	sql.append("       OUT_COSTS7,\n" );
    	sql.append("       OUT_COSTS8,\n" );
    	sql.append("       OUT_COSTS9,\n" );
    	sql.append("       OUT_COSTS10,\n" );
    	sql.append("       OUT_COSTS11,\n" );
    	sql.append("       OUT_COSTS12\n" );
    	sql.append("\n" );
    	sql.append(" FROM (\n" );
    	sql.append("     SELECT ORG_CODE,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS1,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS1,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY1,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS2,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS2,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY2,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS3,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS3,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY3,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS4,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS4,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY4,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS5,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS5,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY5,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS6,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS6,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY6,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS7,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS7,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY7,\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS8,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS8,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY8,\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS9,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS9,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY9,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS10,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS10,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY10,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS11,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS11,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY11,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS12,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS12,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY12,\n" );
    	sql.append("\n" );
    	sql.append("                                    CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS1,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS1,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY1,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS2,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS2,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY2,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS3,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS3,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY3,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS4,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS4,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY4,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS5,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS5,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY5,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS6,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS6,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY6,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS7,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS7,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY7,\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS8,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS8,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY8,\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS9,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS9,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY9,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS10,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS10,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY10,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS11,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS11,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY11,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS12,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS12,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY12,\n" );
    	sql.append("\n" );
    	sql.append("                                         CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS2,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS3,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS4,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS5,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS6,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS7,\n" );
    	sql.append("\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS8,\n" );
    	sql.append("\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS9,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS10,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS11,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS12,\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("                                    CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS2,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS3,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS4,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS5,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS6,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS7,\n" );
    	sql.append("\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS8,\n" );
    	sql.append("                           CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS9,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS10,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS11,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS12\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("                          FROM SE_BU_CLAIM_SETTLE T,SE_BU_CLAIM_SETTLE_REL B\n" );
    	sql.append("                         WHERE 1 = 1 AND B.SETTLE_ID(+) = T.SETTLE_ID\n" );
    	sql.append("                           AND (TO_CHAR(T.SETTLE_DATE, 'YYYY') = '"+year+"' OR\n" );
    	sql.append("                               TO_CHAR(T.SETTLE_DATE, 'YYYY') = '"+bYear+"')\n" );
    	sql.append("                           AND T.STATUS = 100201\n" );
    	sql.append("                           GROUP BY ORG_CODE,SETTLE_DATE ) A, TM_ORG C,TM_ORG D\n" );
    	sql.append("                           WHERE A.ORG_CODE=C.CODE AND C.PID=D.ORG_ID\n" );
    	sql.append("  order by D.ONAME,A.ORG_CODE,C.ONAME");

    	bs=factory.select(sql.toString(), page);
    	return bs;
    }
    /**
     * 服务费用对比(导出)
     */
    public QuerySet download(String year,String bYear) throws Exception {
    	StringBuffer sql= new StringBuffer();
    	sql.append("SELECT D.ONAME OFFICE_NAME,A.ORG_CODE,C.ONAME ORG_NAME,WORK_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS1-OLDWORK_COSTS12)/OLDWORK_COSTS12, 2)\n" );
    	sql.append("       END A1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS1-OLDWORK_COSTS1)/OLDWORK_COSTS1, 2)\n" );
    	sql.append("       END B1,\n" );
    	sql.append("       WORK_COSTS2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS2-WORK_COSTS1)/WORK_COSTS1, 2)\n" );
    	sql.append("       END A2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS2-OLDWORK_COSTS2)/OLDWORK_COSTS2, 2)\n" );
    	sql.append("       END B2,\n" );
    	sql.append("       WORK_COSTS3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN WORK_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS3-WORK_COSTS2)/WORK_COSTS2, 2)\n" );
    	sql.append("       END A3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS3-OLDWORK_COSTS3)/OLDWORK_COSTS3, 2)\n" );
    	sql.append("       END B3,\n" );
    	sql.append("       WORK_COSTS4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN WORK_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS4-WORK_COSTS3)/WORK_COSTS3, 2)\n" );
    	sql.append("       END A4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS4-OLDWORK_COSTS4)/OLDWORK_COSTS4, 2)\n" );
    	sql.append("       END B4,\n" );
    	sql.append("       WORK_COSTS5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS5-WORK_COSTS4)/WORK_COSTS4, 2)\n" );
    	sql.append("       END A5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS5-OLDWORK_COSTS5)/OLDWORK_COSTS5, 2)\n" );
    	sql.append("       END B5,\n" );
    	sql.append("       WORK_COSTS6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN WORK_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS6-WORK_COSTS5)/WORK_COSTS5, 2)\n" );
    	sql.append("       END A6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS6-OLDWORK_COSTS6)/OLDWORK_COSTS6, 2)\n" );
    	sql.append("       END B6,\n" );
    	sql.append("       WORK_COSTS7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS7-WORK_COSTS6)/WORK_COSTS6, 2)\n" );
    	sql.append("       END A7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS7-OLDWORK_COSTS7)/OLDWORK_COSTS7, 2)\n" );
    	sql.append("       END B7,\n" );
    	sql.append("       WORK_COSTS8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN WORK_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS8-WORK_COSTS7)/WORK_COSTS7, 2)\n" );
    	sql.append("       END A8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS8-OLDWORK_COSTS8)/OLDWORK_COSTS8, 2)\n" );
    	sql.append("       END B8,\n" );
    	sql.append("       WORK_COSTS9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS9-WORK_COSTS8)/WORK_COSTS8, 2)\n" );
    	sql.append("       END A9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS9-OLDWORK_COSTS9)/OLDWORK_COSTS9, 2)\n" );
    	sql.append("       END B9,\n" );
    	sql.append("       WORK_COSTS10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN WORK_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS10-WORK_COSTS9)/WORK_COSTS9, 2)\n" );
    	sql.append("       END A10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS10-OLDWORK_COSTS10)/OLDWORK_COSTS10, 2)\n" );
    	sql.append("       END B10,\n" );
    	sql.append("       WORK_COSTS11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN WORK_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS11-WORK_COSTS10)/WORK_COSTS10, 2)\n" );
    	sql.append("       END A11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS11-OLDWORK_COSTS11)/OLDWORK_COSTS11, 2)\n" );
    	sql.append("       END B11,\n" );
    	sql.append("       WORK_COSTS12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN WORK_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS12-WORK_COSTS11)/WORK_COSTS11, 2)\n" );
    	sql.append("       END A12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDWORK_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((WORK_COSTS12-OLDWORK_COSTS12)/OLDWORK_COSTS12, 2)\n" );
    	sql.append("       END B12,\n" );
    	sql.append("       MATERIAL_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS1-OLDMATERIAL_COSTS12)/OLDMATERIAL_COSTS12, 2)\n" );
    	sql.append("       END C1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS1-OLDMATERIAL_COSTS1)/OLDMATERIAL_COSTS1, 2)\n" );
    	sql.append("       END D1,\n" );
    	sql.append("       MATERIAL_COSTS2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS2-MATERIAL_COSTS1)/MATERIAL_COSTS1, 2)\n" );
    	sql.append("       END C2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS2-OLDMATERIAL_COSTS2)/OLDMATERIAL_COSTS2, 2)\n" );
    	sql.append("       END D2,\n" );
    	sql.append("       MATERIAL_COSTS3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS3-MATERIAL_COSTS2)/MATERIAL_COSTS2, 2)\n" );
    	sql.append("       END C3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS3-OLDMATERIAL_COSTS3)/OLDMATERIAL_COSTS3, 2)\n" );
    	sql.append("       END D3,\n" );
    	sql.append("       MATERIAL_COSTS4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS4-MATERIAL_COSTS3)/MATERIAL_COSTS3, 2)\n" );
    	sql.append("       END C4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS4-OLDMATERIAL_COSTS4)/OLDMATERIAL_COSTS4, 2)\n" );
    	sql.append("       END D4,\n" );
    	sql.append("       MATERIAL_COSTS5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS5-MATERIAL_COSTS4)/MATERIAL_COSTS4, 2)\n" );
    	sql.append("       END C5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS5-OLDMATERIAL_COSTS5)/OLDMATERIAL_COSTS5, 2)\n" );
    	sql.append("       END D5,\n" );
    	sql.append("       MATERIAL_COSTS6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS6-MATERIAL_COSTS5)/MATERIAL_COSTS5, 2)\n" );
    	sql.append("       END C6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS6-OLDMATERIAL_COSTS6)/OLDMATERIAL_COSTS6, 2)\n" );
    	sql.append("       END D6,\n" );
    	sql.append("       MATERIAL_COSTS7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS7-MATERIAL_COSTS6)/MATERIAL_COSTS6, 2)\n" );
    	sql.append("       END C7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS7-OLDMATERIAL_COSTS7)/OLDMATERIAL_COSTS7, 2)\n" );
    	sql.append("       END D7,\n" );
    	sql.append("       MATERIAL_COSTS8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS8-MATERIAL_COSTS7)/MATERIAL_COSTS7, 2)\n" );
    	sql.append("       END C8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS8-OLDMATERIAL_COSTS8)/OLDMATERIAL_COSTS8, 2)\n" );
    	sql.append("       END D8,\n" );
    	sql.append("       MATERIAL_COSTS9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS9-MATERIAL_COSTS8)/MATERIAL_COSTS8, 2)\n" );
    	sql.append("       END C9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS9-OLDMATERIAL_COSTS9)/OLDMATERIAL_COSTS9, 2)\n" );
    	sql.append("       END D9,\n" );
    	sql.append("       MATERIAL_COSTS10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS10-MATERIAL_COSTS9)/MATERIAL_COSTS9, 2)\n" );
    	sql.append("       END C10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS10-OLDMATERIAL_COSTS10)/OLDMATERIAL_COSTS10, 2)\n" );
    	sql.append("       END D10,\n" );
    	sql.append("       MATERIAL_COSTS11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS11-MATERIAL_COSTS10)/MATERIAL_COSTS10, 2)\n" );
    	sql.append("       END C11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS11-OLDMATERIAL_COSTS11)/OLDMATERIAL_COSTS11, 2)\n" );
    	sql.append("       END D11,\n" );
    	sql.append("       MATERIAL_COSTS12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN MATERIAL_COSTS11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS12-MATERIAL_COSTS11)/MATERIAL_COSTS11, 2)\n" );
    	sql.append("       END C12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDMATERIAL_COSTS12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((MATERIAL_COSTS12-OLDMATERIAL_COSTS12)/OLDMATERIAL_COSTS12, 2)\n" );
    	sql.append("       END D12,\n" );
    	sql.append("       SUMMARY1,\n" );
    	sql.append("\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN OLDSUMMARY12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY1-OLDSUMMARY12)/OLDSUMMARY12, 2)\n" );
    	sql.append("       END E1,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY1-OLDSUMMARY1)/OLDSUMMARY1, 2)\n" );
    	sql.append("       END F1,\n" );
    	sql.append("       SUMMARY2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY1 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY2-SUMMARY1)/SUMMARY1, 2)\n" );
    	sql.append("       END E2,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY2-OLDSUMMARY2)/OLDSUMMARY2, 2)\n" );
    	sql.append("       END F2,\n" );
    	sql.append("       SUMMARY3,\n" );
    	sql.append("            CASE\n" );
    	sql.append("         WHEN SUMMARY2 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY3-SUMMARY2)/SUMMARY2, 2)\n" );
    	sql.append("       END E3,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY3-OLDSUMMARY3)/OLDSUMMARY3, 2)\n" );
    	sql.append("       END F3,\n" );
    	sql.append("       SUMMARY4,\n" );
    	sql.append("      CASE\n" );
    	sql.append("         WHEN SUMMARY3 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY4-SUMMARY3)/SUMMARY3, 2)\n" );
    	sql.append("       END E4,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY4-OLDSUMMARY4)/OLDSUMMARY4, 2)\n" );
    	sql.append("       END F4,\n" );
    	sql.append("       SUMMARY5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY4 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY5-SUMMARY4)/SUMMARY4, 2)\n" );
    	sql.append("       END E5,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY5-OLDSUMMARY5)/OLDSUMMARY5, 2)\n" );
    	sql.append("       END F5,\n" );
    	sql.append("       SUMMARY6,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN SUMMARY5 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY6-SUMMARY5)/SUMMARY5, 2)\n" );
    	sql.append("       END E6,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY6-OLDSUMMARY6)/OLDSUMMARY6, 2)\n" );
    	sql.append("       END F6,\n" );
    	sql.append("       SUMMARY7,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY6 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY7-SUMMARY6)/SUMMARY6, 2)\n" );
    	sql.append("       END E7,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY7-OLDSUMMARY7)/OLDSUMMARY7, 2)\n" );
    	sql.append("       END F7,\n" );
    	sql.append("       SUMMARY8,\n" );
    	sql.append("           CASE\n" );
    	sql.append("         WHEN SUMMARY7 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY8-SUMMARY7)/SUMMARY7, 2)\n" );
    	sql.append("       END E8,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY8-OLDSUMMARY8)/OLDSUMMARY8, 2)\n" );
    	sql.append("       END F8,\n" );
    	sql.append("       SUMMARY9,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY8 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY9-SUMMARY8)/SUMMARY8, 2)\n" );
    	sql.append("       END E9,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY9-OLDSUMMARY9)/OLDSUMMARY9, 2)\n" );
    	sql.append("       END F9,\n" );
    	sql.append("       SUMMARY10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN SUMMARY9 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY10-SUMMARY9)/SUMMARY9, 2)\n" );
    	sql.append("       END E10,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY10-OLDSUMMARY10)/OLDSUMMARY10, 2)\n" );
    	sql.append("       END F10,\n" );
    	sql.append("       SUMMARY11,\n" );
    	sql.append("          CASE\n" );
    	sql.append("         WHEN SUMMARY10 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY11-SUMMARY10)/SUMMARY10, 2)\n" );
    	sql.append("       END E11,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY11-OLDSUMMARY11)/OLDSUMMARY11, 2)\n" );
    	sql.append("       END F11,\n" );
    	sql.append("       SUMMARY12,\n" );
    	sql.append("         CASE\n" );
    	sql.append("         WHEN SUMMARY11 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY12-SUMMARY11)/SUMMARY11, 2)\n" );
    	sql.append("       END E12,\n" );
    	sql.append("        CASE\n" );
    	sql.append("         WHEN OLDSUMMARY12 = 0 THEN\n" );
    	sql.append("          0\n" );
    	sql.append("         ELSE\n" );
    	sql.append("\n" );
    	sql.append("          ROUND((SUMMARY12-OLDSUMMARY12)/OLDSUMMARY12, 2)\n" );
    	sql.append("       END F12,\n" );
    	sql.append("       OUT_COSTS1,\n" );
    	sql.append("       OUT_COSTS2,\n" );
    	sql.append("       OUT_COSTS3,\n" );
    	sql.append("       OUT_COSTS4,\n" );
    	sql.append("       OUT_COSTS5,\n" );
    	sql.append("       OUT_COSTS6,\n" );
    	sql.append("       OUT_COSTS7,\n" );
    	sql.append("       OUT_COSTS8,\n" );
    	sql.append("       OUT_COSTS9,\n" );
    	sql.append("       OUT_COSTS10,\n" );
    	sql.append("       OUT_COSTS11,\n" );
    	sql.append("       OUT_COSTS12\n" );
    	sql.append("\n" );
    	sql.append(" FROM (\n" );
    	sql.append("     SELECT ORG_CODE,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS1,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS1,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY1,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS2,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS2,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY2,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS3,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS3,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY3,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS4,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS4,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY4,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS5,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS5,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY5,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS6,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS6,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY6,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS7,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS7,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY7,\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS8,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS8,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY8,\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS9,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS9,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY9,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS10,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS10,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY10,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS11,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS11,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY11,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  WORK_COSTS12,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  MATERIAL_COSTS12,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  SUMMARY12,\n" );
    	sql.append("\n" );
    	sql.append("                                    CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS1,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS1,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY1,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS2,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS2,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY2,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS3,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS3,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY3,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS4,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS4,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY4,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS5,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS5,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY5,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS6,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS6,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY6,\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS7,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS7,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY7,\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS8,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS8,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY8,\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS9,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS9,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY9,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS10,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS10,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY10,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS11,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS11,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY11,\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.WORK_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDWORK_COSTS12,\n" );
    	sql.append("                                 CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM( NVL(B.MATERIAL_COSTS, 0) )\n" );
    	sql.append("                              ELSE 0 END  OLDMATERIAL_COSTS12,\n" );
    	sql.append("                               CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(  NVL(T.SUMMARY, 0))  ELSE 0 END  OLDSUMMARY12,\n" );
    	sql.append("\n" );
    	sql.append("                                         CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS2,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS3,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS4,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS5,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS6,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS7,\n" );
    	sql.append("\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS8,\n" );
    	sql.append("\n" );
    	sql.append("                              CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS9,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS10,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS11,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+year+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OUT_COSTS12,\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("                                    CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '01' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS1,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '02' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS2,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '03' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS3,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '04' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS4,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '05' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS5,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '06' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS6,\n" );
    	sql.append("\n" );
    	sql.append("                          CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '07' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS7,\n" );
    	sql.append("\n" );
    	sql.append("                            CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '08' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS8,\n" );
    	sql.append("                           CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '09' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS9,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '10' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS10,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '11' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS11,\n" );
    	sql.append("\n" );
    	sql.append("                                  CASE WHEN\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'MM')) = '12' AND\n" );
    	sql.append("                           MAX(TO_CHAR(SETTLE_DATE, 'YYYY')) = '"+bYear+"' THEN\n" );
    	sql.append("                              SUM(NVL(B.OUT_COSTS, 0))\n" );
    	sql.append("                              ELSE 0 END  OLDOUT_COSTS12\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("\n" );
    	sql.append("                          FROM SE_BU_CLAIM_SETTLE T,SE_BU_CLAIM_SETTLE_REL B\n" );
    	sql.append("                         WHERE 1 = 1 AND B.SETTLE_ID(+) = T.SETTLE_ID\n" );
    	sql.append("                           AND (TO_CHAR(T.SETTLE_DATE, 'YYYY') = '"+year+"' OR\n" );
    	sql.append("                               TO_CHAR(T.SETTLE_DATE, 'YYYY') = '"+bYear+"')\n" );
    	sql.append("                           AND T.STATUS = 100201\n" );
    	sql.append("                           GROUP BY ORG_CODE,SETTLE_DATE ) A, TM_ORG C,TM_ORG D\n" );
    	sql.append("                           WHERE A.ORG_CODE=C.CODE AND C.PID=D.ORG_ID\n" );
    	sql.append("  order by D.ONAME,A.ORG_CODE,C.ONAME");

        //执行方法，不需要传递conn参数
        return factory.select(null, sql.toString());
    }
    
}
